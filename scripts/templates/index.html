<!-- /scripts/templates/index.html -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Playwright Reports</title>

  <style>
    :root {
      --bg-color: #ffffff;
      --text-color: #111111;
      --card-bg: #fafafa;
      --border-color: #cccccc;
      --table-header-bg: #eeeeee;
      --link-color: #0066cc;
    }

    body.dark-mode {
      --bg-color: #111827;
      --text-color: #e5e7eb;
      --card-bg: #1f2937;
      --border-color: #374151;
      --table-header-bg: #374151;
      --link-color: #60a5fa;
    }

    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      padding: 20px;
      max-width: 1000px;
      margin: auto;
      background: var(--bg-color);
      color: var(--text-color);
      transition: background 0.2s ease, color 0.2s ease;
    }

    h1 {
      margin-bottom: 5px;
    }

    a {
      color: var(--link-color);
    }

    .badge {
      display: inline-block;
      padding: 3px 8px;
      border-radius: 12px;
      color: #fff;
      font-size: 12px;
      margin-right: 6px;
    }

    .os-badge {
      background: #555;
    }

    .browser-badge {
      background: #777;
    }

    .status-pill {
      display: inline-block;
      padding: 3px 10px;
      border-radius: 12px;
      font-weight: bold;
      font-size: 12px;
    }

    .pill-pass {
      background: #d6f5d6;
      color: #0a4;
    }

    .pill-fail {
      background: #ffd6d6;
      color: #a00;
    }

    .pill-skip {
      background: #fff2b3;
      color: #a68b00;
    }

    .pill-none {
      background: #e3e3e3;
      color: #555;
    }

    body.dark-mode .pill-pass {
      background: #14532d;
      color: #bbf7d0;
    }

    body.dark-mode .pill-fail {
      background: #7f1d1d;
      color: #fecaca;
    }

    body.dark-mode .pill-skip {
      background: #78350f;
      color: #fef3c7;
    }

    body.dark-mode .pill-none {
      background: #4b5563;
      color: #e5e7eb;
    }

    .report-block {
      border: 1px solid var(--border-color);
      padding: 12px;
      margin: 12px 0;
      border-radius: 8px;
      background: var(--card-bg);
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.06);
      transition:
        box-shadow 0.15s ease,
        transform 0.15s ease,
        background 0.2s ease,
        border-color 0.2s ease;
    }

    .report-block:hover {
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.18);
      transform: translateY(-1px);
    }

    .report-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      cursor: pointer;
      gap: 10px;
    }

    .report-header-main {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .caret {
      font-size: 14px;
      margin-left: 10px;
      opacity: 0.7;
    }

    .report-content {
      margin-top: 10px;
    }

    .report-block.collapsed .report-content {
      display: none;
    }

    .report-meta-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 4px 16px;
      margin-bottom: 8px;
    }

    .meta-row {
      display: flex;
      justify-content: space-between;
      font-size: 13px;
    }

    .meta-label {
      font-weight: 600;
      margin-right: 6px;
    }

    .meta-value {
      text-align: right;
      opacity: 0.9;
    }

    .quick-summary {
      font-size: 13px;
      margin: 6px 0 10px;
    }

    .quick-summary strong {
      font-weight: 600;
    }

    .links {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 4px;
    }

    .link-pill {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid var(--border-color);
      font-size: 12px;
      text-decoration: none;
      background: var(--card-bg);
      transition: background 0.15s ease, border-color 0.15s ease;
      white-space: nowrap;
    }

    .link-pill:hover {
      background: var(--table-header-bg);
      border-color: var(--link-color);
    }

    table.summary {
      border-collapse: collapse;
      margin-top: 10px;
      margin-bottom: 20px;
      width: 100%;
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      overflow: hidden;
    }

    table.summary th,
    table.summary td {
      border-bottom: 1px solid var(--border-color);
      padding: 6px 8px;
      font-size: 14px;
    }

    table.summary th {
      background: var(--table-header-bg);
    }

    .summary td.status-cell {
      text-align: center;
      width: 140px;
    }

    .summary td.num-cell {
      text-align: right;
    }

    .toolbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 10px;
      margin: 10px 0 20px;
    }

    .toggle-btn,
    .filter-btn {
      border: 1px solid var(--border-color);
      background: var(--card-bg);
      color: var(--text-color);
      padding: 5px 10px;
      border-radius: 999px;
      cursor: pointer;
      font-size: 13px;
      transition:
        background 0.15s ease,
        border-color 0.15s ease,
        color 0.15s ease;
    }

    .toggle-btn:hover,
    .filter-btn:hover {
      background: var(--table-header-bg);
    }

    .filter-group {
      display: flex;
      align-items: center;
      gap: 6px;
      flex-wrap: wrap;
    }

    .filter-label {
      font-size: 13px;
      opacity: 0.8;
    }

    .filter-btn.active {
      border-color: #2563eb;
      color: #2563eb;
    }

    body.dark-mode .filter-btn.active {
      border-color: #60a5fa;
      color: #60a5fa;
    }

    footer {
      margin-top: 40px;
      font-size: 12px;
      color: #555;
      text-align: center;
    }

    body.dark-mode footer {
      color: #9ca3af;
    }
  </style>
</head>

<body>

  <h1>Playwright Reports</h1>

  <p><strong>Published (UTC):</strong> {{PUBLISH_TIMESTAMP}}</p>
  <p><strong>Commit:</strong> {{COMMIT_SHA}}</p>
  <p><strong>Run:</strong> #{{RUN_NUMBER}}</p>
  <p><a href="{{RUN_URL}}">View Full Run Logs</a></p>

  <div class="toolbar">
    <button id="theme-toggle" class="toggle-btn">ðŸŒ™ Dark mode</button>

    <div class="filter-group">
      <span class="filter-label">Filter by status:</span>
      <button class="filter-btn active" data-filter="all">All</button>
      <button class="filter-btn" data-filter="fail">Fail</button>
      <button class="filter-btn" data-filter="skip">Skipped</button>
      <button class="filter-btn" data-filter="pass">Pass</button>
    </div>
  </div>

  <hr>

  <h2>Summary</h2>
  {{SUMMARY_TABLE}}

  <hr>

  <h2>Report List</h2>
  {{REPORT_LIST}}

  <footer>
    Generated automatically by GitHub Actions.
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const body = document.body;
      const themeToggle = document.getElementById('theme-toggle');

      // THEME
      const savedTheme = localStorage.getItem('pw-theme');
      if (savedTheme === 'dark') {
        body.classList.add('dark-mode');
        if (themeToggle) themeToggle.textContent = 'â˜€ï¸ Light mode';
      }

      if (themeToggle) {
        themeToggle.addEventListener('click', () => {
          body.classList.toggle('dark-mode');
          const isDark = body.classList.contains('dark-mode');
          localStorage.setItem('pw-theme', isDark ? 'dark' : 'light');
          themeToggle.textContent = isDark ? 'â˜€ï¸ Light mode' : 'ðŸŒ™ Dark mode';
        });
      }

      // FILTERS
      const filterButtons = document.querySelectorAll('.filter-btn');

      function applyFilter(filter) {
        const rows = document.querySelectorAll('.summary-row');
        const blocks = document.querySelectorAll('.report-block');

        rows.forEach(row => {
          const status = (row.dataset.status || '').toLowerCase();
          row.style.display = (filter === 'all' || status === filter) ? '' : 'none';
        });

        blocks.forEach(block => {
          const status = (block.dataset.status || '').toLowerCase();
          block.style.display = (filter === 'all' || status === filter) ? '' : 'none';
        });
      }

      filterButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          filterButtons.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          applyFilter(btn.dataset.filter);
        });
      });

      // COLLAPSIBLE REPORT BLOCKS
      const reportBlocks = document.querySelectorAll('.report-block');
      reportBlocks.forEach(block => {
        const header = block.querySelector('.report-header');
        const caret = block.querySelector('.caret');
        const status = (block.dataset.status || '').toLowerCase();

        // Default: PASS + NONE collapsed, FAIL + SKIP expanded
        if (status === 'pass' || status === 'none') {
          block.classList.add('collapsed');
          if (caret) caret.textContent = 'â–¶';
        } else {
          if (caret) caret.textContent = 'â–¼';
        }

        if (header) {
          header.addEventListener('click', () => {
            const isCollapsed = block.classList.toggle('collapsed');
            if (caret) caret.textContent = isCollapsed ? 'â–¶' : 'â–¼';
          });
        }
      });
    });
  </script>

</body>

</html>